<!DOCTYPE html>
<html>
<head>
    <title>Dashboard</title>
    <style>
        body {font-family: Arial, Helvetica, sans-serif; background-color: black;color: white; margin: 50px;}
        /* Clear floats after the columns */
        .row:after {
            content: "";
            display: table;
            clear: both;
        }
        .rowbreak:after {
            content: "";
            display: table;
            clear: both;
            margin-bottom: 50px;
        }
        .column.left {float: left; width:50%; text-align: left;}
        .column.right {float: right;width:50%; text-align: right;}
        .date {color:lightgrey; font-size: 35px;}
        .large {color: white; text-decoration: none; font-size: 60px; }
        .small {font-size: 30px; color:lightgrey}
        .verysmall {font-size: 20px; color:lightgrey}
        .floatleft {float: left;}
        .floatright {float:right;}
        .space {margin-right: 10px;}
        hr { width: 40%; }
    </style>
    <!-- icons: -->
    <script src="https://kit.fontawesome.com/a8f721cb81.js" crossorigin="anonymous"></script>
    <script>
        function startup(){
            // Handler for the timer functions
            startTime();
            updateWeather();
            updateForecast();
        }
        function startTime() {
            var days    = ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];
            var months  = ['January','February','March','April','May','June','July','August','September','October','November','December'];
            var today = new Date();
            var h = today.getHours();
            var m = today.getMinutes();
            var s = today.getSeconds();
            h = checkTime(h);
            m = checkTime(m);
            s = checkTime(s);
            document.getElementById('timemain').innerHTML = h + ":" + m;
            document.getElementById('timeseconds').innerHTML = s;
            document.getElementById('date').innerHTML = days[ today.getDay() ].concat(', ', today.getDate(), ' ', months[ today.getMonth() ], ', ', today.getYear()+1900 );
            var t1 = setTimeout(startTime, 500); // run this again in 0.5s
        }
        function checkTime(i) {
          if (i < 10) {i = "0" + i};  // add zero in front of numbers < 10
          return i;
        }
        function updateWeather() {
            // Update the weather
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
                    // response has been made - interpret the JSON:
                    var jsonObj = JSON.parse(this.responseText);
                    document.getElementById('weather').innerHTML = jsonObj["weather"][0]["description"]
                    var temp = Math.round(jsonObj['main']["temp"] - 273.15)
                    document.getElementById('temperature').innerHTML = temp.toString().concat('\xB0')
                    temp = Math.round(jsonObj['main']["feels_like"] - 273.15)
                    var prefix = 'Feels like '
                    document.getElementById('realfeel').innerHTML = prefix.concat(temp.toString(),'\xB0')
                    //Update the weather icon:
                    document.getElementById("weathericon").src = "https://openweathermap.org/img/wn/".concat(jsonObj["weather"][0]["icon"], '@2x.png')
                    //Sunrise and Sunset
                    var dateObj = new Date(jsonObj["sys"]["sunrise"] * 1000)
                    var h = dateObj.getHours();
                    var m = dateObj.getMinutes();
                    h = checkTime(h);
                    m = checkTime(m);
                    document.getElementById('sunrise').innerHTML = h + ":" + m;
                    var dateObj = new Date(jsonObj["sys"]["sunset"] * 1000)
                    var h = dateObj.getHours();
                    var m = dateObj.getMinutes();
                    h = checkTime(h);
                    m = checkTime(m);
                    document.getElementById('sunset').innerHTML = h + ":" + m;
                }
            };
            xhttp.open("GET", "https://api.openweathermap.org/data/2.5/weather?id=2647793&appid=b91ea3be51203e1d8fb7da23377a37f2", true);
            xhttp.send();
            var t2 = setTimeout(updateWeather, 1000*10*60); // run this again in 10min
        }
        function updateForecast() {
            // Update the weather
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
                    // response has been made - interpret the JSON:
                    var jsonObj = JSON.parse(this.responseText);
                }
            };
            xhttp.open("GET", "https://api.openweathermap.org/data/2.5/forecast?id=2647793&appid=b91ea3be51203e1d8fb7da23377a37f2", true);
            xhttp.send();
            var t3 = setTimeout(updateForecast, 1000*10*60); // run this again in 10min
        }
    </script>
</head>
<body onload="startup()">
    <div class="column left">
        <div class="row">
            <i class="fas fa-sun floatleft"></i>
            <div id="sunrise" class="verysmall floatleft space"></div>
            <i class="fas fa-moon floatleft"></i>
            <div id="sunset" class="verysmall floatleft"></div>
        </div>
        <div class="row">
            <img id="weathericon" class="floatleft" width="80" height="80">
            <div id="temperature" class="large floatleft"></div>
        </div>
        <div class="row">
            <div id="realfeel" class="small"></div>
        </div>
        <div class="rowbreak">
            <div id="weather" class="small"></div>
        </div>
        <div class="row">
            <div class="verysmall">Weather Forecast</div>
        </div>
        <div class="row">
            <hr class="floatleft">
        </div>
    </div>
    <div class="column right">
        <div class="row">
            <div id="date" class="date"></div>
        </div>
        <div class="rowbreak">
            <div id="timeseconds" class="small floatright"></div>
            <div id="timemain" class="large"></div>
        </div>
    </div>
</body>
</html>